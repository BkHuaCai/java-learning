# 索引

### 什么是索引
索引（index）是存储引擎用于高效快速获取数据的一种数据结构。
在数据之外，数据库系统还维护着满足特定查找算法的数据结构，
这些数据结构以某种方式引用（指向）数据，这样就可以在这些数据结构上实现高级查找算法，
这种数据结构就是索引。更通俗的说，索引就相当于目录。为了方便查找书中的内容，
通过对内容建立索引形成目录，如果有目录了，我们只需要先去目录里查找字的位置，
然后直接翻到那一页就行了。索引优化是对查询性能优化最有效的手段。

### 索引的优缺点
**优点**:
- 索引大大减少了服务器需要扫描的数据量，提高了数据检索的效率，降低了数据库的IO成本。
- 索引可以帮助服务器避免排序和临时表（索引本身基于B+树，已经排好序了），降低排序的成本。
  在没有索引时，需要将数据加载到内存中，然后再用一些排序算法在内存中进行排序。
  有时候查询到结果集可能太大以至于无法再内存中精选排序，此时就需要暂时借助磁盘的空间来存放中间结果，
  在排序操作完成后再把排好序的结果返回给客户端。

**缺点**:
- 空间方面: 索引需要占用物理空间。
- 时间方面: 虽然索引大大提高了查询效率，同时也降低了更新表的速度，如对表进行insert、update、delete时，效率降低。
  使用索引也不一定能提高查询性能，大多数情况下，索引查询都是比全表扫描要快。
  但是如果数据库的数据量不大，那么使用索引也不一定能能够带来很大提升。
  比如在执行查询语句前，需要生成执行计划，计算使用不同索引执行查询所需要的成本，如果建了太多索引，
  可能导致导致成本分析过程耗时太多，从而影响语句的执行性能。

### 覆盖索引
定义：如果一个索引包含(或者说覆盖)所有需要查询的字段的值，就称之为“覆盖索引”。<p>
优点：覆盖索引即锁需要查询的字段正好是索引字段，那么就可以直接根据该索引查到数据，不需要回表查询。<p>
在InnoDB存储引擎中，如果不是主键索引，叶子节点存储的是[主键+列值]。最终还要回表，也就是要通过主键再查找一次。
这样就会比较慢，覆盖索引就是要把查询出的列和索引是对应的，不做回表操作！！
- 主键索引: 如果一条SQL需要查询主键，那么正好根据主键索引可以查到主键。
- 普通索引: 如果一条SQL需要查询name，name字段刚好有索引，那么根据这个索引就可以查到数据，也就不要回表查询。

### 最左前缀原则
最左前缀原则就是最左优先，在创建多列索引是，要根据业务需求，where子句中使用最频繁的一列放在最左边。
MySQL会一直向右匹配直到遇到范围查询（>、<、between、like、!=）就会停止匹配，
范围列可以用到索引，但是范围列后面的列无法用到索引。

**举例：** 比如`a = 1 and b = 2 and c > 3 and d = 4`如果建立(a,b,c,d)顺序的索引，d是用不到索引的。
如果建立(a,b,d,c)的索引则都可以用到，其中a,b,d的顺序可以任意调整。